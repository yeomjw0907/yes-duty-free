# 관리자 페이지 명세 (Admin Page Specification)

> Yes Duty Free 관리자에서 **볼 수 있는 항목**과 **처리할 수 있는 작업**을 정의합니다.  
> 작성일: 2026-02-10

---

## 1. 개요

| 항목 | 내용 |
|------|------|
| **목적** | 주문·배송 처리, 상품·쿠폰·공지 관리, 회원·매출 조회 등 운영 업무 수행 |
| **접근** | 사이트 내 관리자 로그인(이메일/비밀번호) 후 패널 진입 (현재: 별도 로그인 다이얼로그) |
| **권한** | 추후 `admin_users` 테이블 및 role(super_admin, admin, staff) 기반 세분화 가능. 1차는 단일 관리자 계정 가정 |

---

## 2. 메뉴 구조 (사이드바)

| 메뉴 ID | 메뉴명 | 설명 | 우선순위 |
|---------|--------|------|----------|
| `dashboard` | 대시보드 | 요약 지표, 최근 주문/매출 한눈에 | 🟡 |
| `orders` | 주문/해외배송 관리 | 주문 목록·상세, 상태 변경, 송장 등록 | 🔴 |
| `products` | 면세상품 관리 | 상품 목록·등록·수정·삭제, 카테고리 연결 | 🔴 |
| `members` | 회원 관리 | 회원 목록·등급·포인트 조회/수정 | 🟡 |
| `coupons` | 글로벌 쿠폰 관리 | 쿠폰 생성·수정·목록, 사용자 발급 현황 | 🟡 |
| `reviews` | 리뷰 관리 | 리뷰 목록·조회, 숨김/삭제 | 🟡 |
| `live` | 라이브 방송 관리 | 라이브 목록·등록·수정, 예정일·상태·임베드 | 🟡 |
| `banners` | 배너 관리 | 배너 목록·노출 순서 CRUD | 🟠 |
| `notices` | 공지/이벤트 관리 | 공지·이벤트 CRUD (events 테이블 등) | 🟡 |
| `insights` | 인사이트 관리 | 검색어·매출 트렌드 등 (선택) | 🟠 |

---

## 3. 화면별 상세: 무엇을 보고, 무엇을 처리하는가

### 3.1 대시보드 (`dashboard`)

**볼 수 있는 것**
- 오늘/주간/월간 주문 건수, 매출 합계 (orders 기준)
- 상태별 주문 수 (결제대기, 상품준비중, 배송중, 배송완료 등)
- 최근 주문 목록 (최신 N건)
- (선택) 회원 가입 추이, 인기 상품 TOP N

**처리할 수 있는 것**
- 별도 “처리” 없음. 조회·모니터링용.
- 요약 숫자는 `orders`, `users` 집계로 구현.

**데이터 소스**
- `orders` (status, total_amount, created_at)
- `users` (created_at)

---

### 3.2 주문/해외배송 관리 (`orders`)

**볼 수 있는 것**
- 주문 목록: 주문번호, 주문일시, **상태**, 주문자(이름·연락처), 배송지, 주문 상품(이름·브랜드·수량·금액), 상품금액/배송비/할인/적립금/총 결제금액, **택배사·송장번호**, 결제수단, 배송 메모, 관리자 메모
- 상태 필터: 전체, 결제대기, 상품준비중, 배송대기, 배송중, 해외배송중, 현지집하완료, 통관진행중, 배송완료, 취소/반품
- 정렬: 주문일시 최신순 기본

**처리할 수 있는 것**
- **주문 상태 변경**: 결제대기 → 상품준비중 → 배송대기 → 배송중 → 배송완료 등 (DB `orders.status` 업데이트)
- **물류 정보 입력/수정**: 택배사(`courier_company`), 송장번호(`tracking_number`), (선택) 출고일(`shipped_at`), 배송완료일(`delivered_at`)
- **관리자 메모**: `admin_memo` 저장 (내부 업무용)
- (추가 검토) 취소/반품 접수 시 상태 변경, `cancel_reason`, `cancelled_at` 등
- (추가 검토) 엑셀 다운로드, 송장 일괄 등록

**데이터 소스**
- `orders` (전체 컬럼)
- `order_items` (주문별 상품 스냅샷)
- `users` (주문자 이름·이메일 등, user_id로 조인)

---

### 3.3 면세상품 관리 (`products`)

**볼 수 있는 것**
- 상품 목록: 썸네일, 상품명, 브랜드, 카테고리, 판매가/정가/할인율, 재고, 노출 여부, 판매량 등
- 카테고리별/검색 필터
- 상품 상세: 기본 정보 + 옵션(product_options), 상세 설명, 이미지 다중 등

**처리할 수 있는 것**
- **상품 등록**: 이름, 브랜드, 가격, 정가, 카테고리, 이미지, 재고, 상세 설명, 노출 여부 등 입력 후 `products` insert, 필요 시 `product_options` insert
- **상품 수정**: 위 항목 수정 후 `products`/`product_options` update
- **상품 삭제/비노출**: 삭제 또는 `is_active = false` 처리
- **재고 수정**: `stock_quantity` 업데이트
- (선택) **카테고리 관리**: `categories` CRUD (이름, 순서 등)

**데이터 소스**
- `products`
- `product_options`
- `categories`

---

### 3.4 공지/이벤트 관리 (`notices`)

**볼 수 있는 것**
- 공지·이벤트 목록: 제목, 유형(공지/이벤트), 게시 기간(start~end), 등록일, 노출 여부
- 상세: 제목, 본문(content), 유형, 기간

**처리할 수 있는 것**
- **공지/이벤트 등록**: 제목, 본문, 유형, 시작일·종료일 → `events` insert
- **수정/삭제**: `events` update 또는 delete

**데이터 소스**
- `events` (title, content, type, starts_at, ends_at 등. 테이블 미생성 시 추후 추가)

---

### 3.5 인사이트 관리 (`insights`)

**볼 수 있는 것**
- (선택) 인기 검색어: `search_keywords` 기반
- (선택) 카테고리/상품별 매출, 주문 트렌드

**처리할 수 있는 것**
- 조회 위주. 필요 시 검색어 초기화 등 관리 기능 추가 검토.

**데이터 소스**
- `search_keywords`, `orders`, `order_items`

---

### 3.6 글로벌 쿠폰 관리 (`coupons`)

**볼 수 있는 것**
- 쿠폰 목록: 쿠폰 코드, 제목, 할인 유형(정액/정률), 할인값, 최소 주문금액, 유효기간, 사용 한도/사용 횟수, 활성 여부
- (선택) 쿠폰별 발급·사용 건수 (`user_coupons` 집계)

**처리할 수 있는 것**
- **쿠폰 생성**: 코드, 제목, 할인 유형·값, 최소 주문금액, 유효기간, 최대 할인금액(정률 시) 등 → `coupons` insert
- **쿠폰 수정**: 유효기간 연장, 비활성화 등 → `coupons` update
- (선택) **특정 회원에게 쿠폰 발급**: `user_coupons` insert

**데이터 소스**
- `coupons`
- `user_coupons`

---

### 3.7 회원 관리 (`members`)

**볼 수 있는 것**
- 회원 목록: 이메일, 이름, 전화번호, **등급**(Basic/Premium/VIP), **포인트**, 가입일, 최근 로그인
- 검색: 이메일·이름·전화번호
- (선택) 회원별 주문 건수, 총 구매 금액

**처리할 수 있는 것**
- **조회**: 회원 상세(배송지 목록, 주문 요약 등)
- **(선택) 등급 수정**: `membership_tier` 변경
- **(선택) 포인트 수정**: `points` 증감 (사유 메모 등은 별도 정책)

**데이터 소스**
- `users`

---

### 3.8 라이브 방송 관리 (`live`)

**볼 수 있는 것**
- 라이브 목록: 제목, 썸네일, **상태**(예정/진행중/종료), 영상 링크(stream_url), 예정일, 시청자 수 등
- 상세: 제품 링크(연결 상품 ID 목록)

**처리할 수 있는 것**
- **등록**: 제목, 썸네일 URL, 영상 링크(페이스북 등), 예정일, 상태 → `live_streams` insert
- **수정**: 제목·썸네일·영상 링크·예정일·상태·제품 링크 update
- **삭제**: `live_streams` delete
- 사이트 라이브 페이지에서 임베드 재생용 데이터 제공

**데이터 소스**
- `live_streams`

---

### 3.9 배너 관리 (`banners`)

**볼 수 있는 것**
- 배너 목록: 제목, 이미지 URL, 링크 URL, 위치(position), 노출 순서(display_order), 활성 여부
- 정렬: 위치·순서별

**처리할 수 있는 것**
- **CRUD**: 배너 등록·수정·삭제
- **순서 변경**: `display_order` 업데이트
- 메인/서브 등 `position`별 노출 제어

**데이터 소스**
- `banners` (테이블 미생성 시 추후 추가)

---

### 3.10 리뷰 관리 (`reviews`)

**볼 수 있는 것**
- 리뷰 목록: 상품명, 작성자(이메일·이름), 평점, 제목·내용, 작성일, 구매확정 여부
- 필터: 상품별, 평점별, 기간
- (선택) 신고/숨김 처리 상태

**처리할 수 있는 것**
- **조회**: 리뷰 상세
- **(선택) 숨김/삭제**: 부적절 리뷰 비노출 또는 삭제 (컬럼 추가 시 `is_hidden` 등)
- (선택) 답글 등

**데이터 소스**
- `reviews`
- `products` (상품명)
- `users` (작성자)

---

## 4. 데이터 소스 요약 (테이블 매핑)

| 메뉴 | 주 테이블 | 보조 테이블 |
|------|-----------|-------------|
| 대시보드 | orders, users | order_items |
| 주문/해외배송 | orders, order_items | users |
| 면세상품 | products, product_options | categories |
| 회원 관리 | users | - |
| 쿠폰 | coupons | user_coupons |
| 리뷰 관리 | reviews | products, users |
| 라이브 방송 | live_streams | - |
| 배너 관리 | banners | - |
| 공지/이벤트 | events | - |
| 인사이트 | search_keywords, orders | order_items |

---

## 5. 구현 우선순위 제안 (전체)

추가 관리 기능(회원·라이브·배너·리뷰)을 포함한 전체 구현 순서입니다.

| 단계 | 메뉴 | 내용 |
|------|------|------|
| **1단계** | 주문/해외배송 | 실제 DB 연동: 주문 목록 조회, 상태 필터, **상태 변경**, **택배사·송장번호 입력/수정**, admin_memo |
| **2단계** | 면세상품 | 상품 목록 조회, 상품 등록, 상품 수정, 재고 수정, (선택) 카테고리 선택 |
| **3단계** | 회원 관리 | 회원 목록 조회, 검색, (선택) 등급·포인트 수정 |
| **4단계** | 쿠폰 | 쿠폰 목록 조회, 쿠폰 생성, 수정(유효기간·활성), (선택) 회원별 발급 |
| **5단계** | 대시보드 | 주문/매출 요약 숫자, 상태별 건수, 최근 주문 목록 |
| **6단계** | 리뷰 관리 | 리뷰 목록 조회, 상품/작성자 필터, (선택) 숨김/삭제 |
| **7단계** | 라이브 방송 | 라이브 목록 조회, 등록·수정·삭제, 예정일·상태·영상 링크·제품 링크 |
| **8단계** | 배너 관리 | banners 테이블 생성 후 목록·CRUD·노출 순서 |
| **9단계** | 공지/이벤트 | events 테이블 생성 후 CRUD UI |
| **10단계** | 인사이트 | 검색어·매출 트렌드 등 (선택) |

---

## 6. 현재 AdminPanel 상태

- **1단계 완료**: 주문/해외배송 관리 — **실제 DB 연동**. 주문 목록 조회, 상태 필터, 상태·택배사·송장번호·관리자 메모 수정 후 저장.
- **관리자 로그인**: Supabase Auth 로그인 후 `admin_users` 테이블에 등록된 사용자만 Admin 패널 접근 가능. LOGOUT SYSTEM 시 로그아웃 처리.
- **Under Construction**: 대시보드, 면세상품, 회원, 쿠폰, 리뷰, 라이브, 배너, 공지, 인사이트 — 플레이스홀더 화면만 존재.

### 1단계 설정 (주문/해외배송 연동)

1. **Supabase SQL 실행**
   - `database/010_admin_users.sql` — `admin_users` 테이블 생성
   - `database/011_admin_orders_policy.sql` — 관리자 주문 조회/수정 RLS 추가

2. **최초 관리자 등록**
   - Supabase 대시보드 → Authentication → Users 에서 관리자 이메일(예: admin@onecation.co.kr)로 **회원가입** 또는 사용자 생성
   - SQL Editor에서 해당 사용자의 `id`를 `admin_users`에 INSERT:
   ```sql
   INSERT INTO admin_users (user_id) SELECT id FROM auth.users WHERE email = 'admin@onecation.co.kr' LIMIT 1;
   ```

3. **Admin 접속**
   - 사이트에서 관리자 로그인 버튼으로 진입 → 이메일/비밀번호 입력 (위에서 만든 계정)
   - 로그인 성공 시 Admin 패널에서 전체 주문 목록 조회·물류 정보 수정 가능

---

**마지막 업데이트**: 2026-02-10
